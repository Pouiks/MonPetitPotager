{"ast":null,"code":"import _objectSpread from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import React,{createContext,useEffect,useState}from'react';import baseUrl from'../../Config/baseUrl';import{jsx as _jsx}from\"react/jsx-runtime\";export var authContext=/*#__PURE__*/createContext({});var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useState=useState({isLogged:false,token:null,user:null}),_useState2=_slicedToArray(_useState,2),auth=_useState2[0],setAuth=_useState2[1];var setTokenToContext=function setTokenToContext(tokenData){setAuth(_objectSpread(_objectSpread({},auth),{},{token:tokenData}));localStorage.setItem('token',tokenData);};var SetUserIsLog=function SetUserIsLog(isLog){setAuth(_objectSpread(_objectSpread({},auth),{},{isLogged:isLog}));localStorage.setItem('isLog',isLog);};var setUserDataToContext=function setUserDataToContext(userData){setAuth({user:userData});localStorage.setItem('id',userData.id);localStorage.setItem('name',userData.name);localStorage.setItem('role',userData.role);localStorage.setItem('email',userData.email);};var resetContextData=function resetContextData(){setAuth({token:null,user:null,isLogged:false});localStorage.clear();};useEffect(function(){if(auth.token){axios({method:\"post\",url:\"\".concat(baseUrl,\"/authorization\"),headers:{Authorization:\"Bearer \".concat(auth.token)}}).then(function(res){// setUserDataToContext(res.data.authData.user);\nsetAuth(_objectSpread(_objectSpread({},auth),{},{user:res.data.authData.user,isLogged:true}));});}},[auth]);// localStorage\nreturn/*#__PURE__*/_jsx(authContext.Provider,{value:{auth:auth,setTokenToContext:setTokenToContext,setUserDataToContext:setUserDataToContext,resetContextData:resetContextData,SetUserIsLog:SetUserIsLog},children:children});};// AuthProvider.propTypes = {\n//     children: PropTypes.oneOfType([\n//         PropTypes.arrayOf(PropTypes.node),\n//         PropTypes.node,\n//     ]).isRequired,\n// }\nexport default AuthProvider;","map":{"version":3,"names":["axios","React","createContext","useEffect","useState","baseUrl","authContext","AuthProvider","children","isLogged","token","user","auth","setAuth","setTokenToContext","tokenData","localStorage","setItem","SetUserIsLog","isLog","setUserDataToContext","userData","id","name","role","email","resetContextData","clear","method","url","headers","Authorization","then","res","data","authData"],"sources":["/home/virgile/mpp/src/Components/Contexts/index.js"],"sourcesContent":["import axios from 'axios';\nimport React, {createContext, useEffect, useState} from 'react';\nimport baseUrl from '../../Config/baseUrl';\n\nexport const authContext = createContext({});\n\nconst AuthProvider = ({ children }) => {\n\n    const [auth, setAuth] = useState({\n        isLogged: false,\n        token: null,\n        user: null,\n    });\n\n    const setTokenToContext = (tokenData) => {\n        setAuth({...auth, token: tokenData});\n        localStorage.setItem('token', tokenData)\n    }\n    const SetUserIsLog = (isLog) => {\n        setAuth({...auth, isLogged: isLog});\n        localStorage.setItem('isLog', isLog)\n    } \n\n    const setUserDataToContext = (userData) => {\n        setAuth({user: userData});\n        localStorage.setItem('id', userData.id);\n        localStorage.setItem('name', userData.name);\n        localStorage.setItem('role', userData.role);\n        localStorage.setItem('email', userData.email);\n    }\n\n    const resetContextData = () => {\n        setAuth({token: null, user:null, isLogged: false});\n        localStorage.clear();\n    }\n\n    useEffect(() => {\n\n        if(auth.token) {\n            axios({\n                method: \"post\",\n                url:`${baseUrl}/authorization`,\n                headers: {\n                    Authorization: `Bearer ${auth.token}`\n                }\n            }).then((res) => {\n                // setUserDataToContext(res.data.authData.user);\n                setAuth({...auth, user:res.data.authData.user, isLogged: true});\n            });\n        }\n    }, [auth]);\n    \n    // localStorage\n    return (\n        <authContext.Provider value={{auth,setTokenToContext, setUserDataToContext, resetContextData, SetUserIsLog}}>\n            {children}\n        </authContext.Provider>\n    )\n}\n\n\n// AuthProvider.propTypes = {\n//     children: PropTypes.oneOfType([\n//         PropTypes.arrayOf(PropTypes.node),\n//         PropTypes.node,\n//     ]).isRequired,\n// }\n\nexport default AuthProvider;"],"mappings":"6MAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,MAAOC,MAAK,EAAGC,aAAa,CAAEC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CAC/D,MAAOC,QAAO,KAAM,sBAAsB,CAAC,2CAE3C,MAAO,IAAMC,YAAW,cAAGJ,aAAa,CAAC,CAAC,CAAC,CAAC,CAE5C,GAAMK,aAAY,CAAG,QAAfA,aAAY,MAAqB,IAAfC,SAAQ,MAARA,QAAQ,CAE5B,cAAwBJ,QAAQ,CAAC,CAC7BK,QAAQ,CAAE,KAAK,CACfC,KAAK,CAAE,IAAI,CACXC,IAAI,CAAE,IACV,CAAC,CAAC,wCAJKC,IAAI,eAAEC,OAAO,eAMpB,GAAMC,kBAAiB,CAAG,QAApBA,kBAAiB,CAAIC,SAAS,CAAK,CACrCF,OAAO,gCAAKD,IAAI,MAAEF,KAAK,CAAEK,SAAS,GAAE,CACpCC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEF,SAAS,CAAC,CAC5C,CAAC,CACD,GAAMG,aAAY,CAAG,QAAfA,aAAY,CAAIC,KAAK,CAAK,CAC5BN,OAAO,gCAAKD,IAAI,MAAEH,QAAQ,CAAEU,KAAK,GAAE,CACnCH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEE,KAAK,CAAC,CACxC,CAAC,CAED,GAAMC,qBAAoB,CAAG,QAAvBA,qBAAoB,CAAIC,QAAQ,CAAK,CACvCR,OAAO,CAAC,CAACF,IAAI,CAAEU,QAAQ,CAAC,CAAC,CACzBL,YAAY,CAACC,OAAO,CAAC,IAAI,CAAEI,QAAQ,CAACC,EAAE,CAAC,CACvCN,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEI,QAAQ,CAACE,IAAI,CAAC,CAC3CP,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEI,QAAQ,CAACG,IAAI,CAAC,CAC3CR,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEI,QAAQ,CAACI,KAAK,CAAC,CACjD,CAAC,CAED,GAAMC,iBAAgB,CAAG,QAAnBA,iBAAgB,EAAS,CAC3Bb,OAAO,CAAC,CAACH,KAAK,CAAE,IAAI,CAAEC,IAAI,CAAC,IAAI,CAAEF,QAAQ,CAAE,KAAK,CAAC,CAAC,CAClDO,YAAY,CAACW,KAAK,EAAE,CACxB,CAAC,CAEDxB,SAAS,CAAC,UAAM,CAEZ,GAAGS,IAAI,CAACF,KAAK,CAAE,CACXV,KAAK,CAAC,CACF4B,MAAM,CAAE,MAAM,CACdC,GAAG,WAAIxB,OAAO,kBAAgB,CAC9ByB,OAAO,CAAE,CACLC,aAAa,kBAAYnB,IAAI,CAACF,KAAK,CACvC,CACJ,CAAC,CAAC,CAACsB,IAAI,CAAC,SAACC,GAAG,CAAK,CACb;AACApB,OAAO,gCAAKD,IAAI,MAAED,IAAI,CAACsB,GAAG,CAACC,IAAI,CAACC,QAAQ,CAACxB,IAAI,CAAEF,QAAQ,CAAE,IAAI,GAAE,CACnE,CAAC,CAAC,CACN,CACJ,CAAC,CAAE,CAACG,IAAI,CAAC,CAAC,CAEV;AACA,mBACI,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAE,CAACA,IAAI,CAAJA,IAAI,CAACE,iBAAiB,CAAjBA,iBAAiB,CAAEM,oBAAoB,CAApBA,oBAAoB,CAAEM,gBAAgB,CAAhBA,gBAAgB,CAAER,YAAY,CAAZA,YAAY,CAAE,UACvGV,QAAQ,EACU,CAE/B,CAAC,CAGD;AACA;AACA;AACA;AACA;AACA;AAEA,cAAeD,aAAY"},"metadata":{},"sourceType":"module"}