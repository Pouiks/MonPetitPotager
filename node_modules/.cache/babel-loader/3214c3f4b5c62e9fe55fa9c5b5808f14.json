{"ast":null,"code":"import _regeneratorRuntime from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/home/virgile/mpp/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3;import React,{useEffect,useState,useContext}from'react';import{Link,useNavigate}from'react-router-dom';import{authContext}from'../Contexts';import baseUrl from'../../Config/baseUrl';import axios from'axios';import ThemeColors from'../../Config/theme/colors';import Theme from'../../Config/theme/styles';import pxToRem from'../../Services/pxToRem';import{TextField}from'@mui/material';import Button from'../Button';import Text from'../Text';import SignCard from'../SignCard';import H1 from'../H1';import styled from'styled-components';import getLoginToken from'../../Services/login';import getAuth from'../../Services/getAuth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledSignContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: space-around;\\n    width: 500px;\\n    height: 400px;\\n    margin: 0 auto;\\n\"])));var StyledContentSignContainer=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    min-width: 40%;\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: center;\\n    text-align: center;\\n    background-color: \",\"\\n\"])),ThemeColors.secondary);var StyledLink=styled.a(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    max-width: \",\";\\n    align-self:center;\\n    padding: \",\" \",\";\\n    text-decoration: none;\\n    color: white;\\n    border: \",\" solid white;\\n    border-radius: \",\";\\n    font-size:\",\";\\n    margin-bottom: \",\";\\n\\n    &:hover {\\n        background-color: \",\";\\n        border: \",\" solid \",\";\\n    }\\n\"])),pxToRem(200),Theme.padding.sm,Theme.padding.lg,Theme.border.sm,Theme.radius.lg,pxToRem(20),pxToRem(25),ThemeColors.tertiary,Theme.border.sm,ThemeColors.tertiary);var SignIn=function SignIn(){var navigate=useNavigate();// const {user, setUser} = useContext(UserContext)\nvar _useContext=useContext(authContext),auth=_useContext.auth,setTokenToContext=_useContext.setTokenToContext,SetUserIsLog=_useContext.SetUserIsLog;var _useContext2=useContext(authContext),user=_useContext2.user,setUserDataToContext=_useContext2.setUserDataToContext;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var handleEmailChange=function handleEmailChange(e){var email=e.target.value;setEmail(email);};var handlePasswordChange=function handlePasswordChange(e){var password=e.target.value;setPassword(password);};var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var getToken,token,_user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(email===''||password===''){setError('Les informations ne correspondent pas');}_context.next=4;return getLoginToken(email,password);case 4:getToken=_context.sent;token=getToken.data.token;_context.next=8;return getAuth(token);case 8:_user=_context.sent;if(_user){setTokenToContext(_user.data.token);SetUserIsLog(true);setUserDataToContext(_user.data.authData,_user.data.token);}setEmail('');setPassword('');if(_user.data.authData.role===\"admin\"){navigate('/back-office',{user:_user.data.authData});}else{navigate('/mon-potager',_user.data.authData);}_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,15]]);}));return function login(){return _ref.apply(this,arguments);};}();useEffect(function(){},[]);return/*#__PURE__*/_jsxs(SignCard,{children:[/*#__PURE__*/_jsxs(StyledContentSignContainer,{children:[/*#__PURE__*/_jsx(H1,{content:\"Rejoignez nous \"}),/*#__PURE__*/_jsx(Text,{content:\"Cr\\xE9ez votre compte et commencez \\xE0 utiliser nos services\"}),/*#__PURE__*/_jsx(StyledLink,{href:\"/creer-mon-compte\",children:\" Cr\\xE9er mon compte !\"})]}),/*#__PURE__*/_jsxs(StyledSignContainer,{children:[/*#__PURE__*/_jsx(H1,{content:\"Connexion \\xE0 mon compte\"}),/*#__PURE__*/_jsx(TextField,{required:true,id:\"email_outlined-required\",label:\"Email\",defaultValue:email,helperText:error?error:'',onChange:handleEmailChange,error:error?true:false}),/*#__PURE__*/_jsx(TextField,{required:true,id:\"password_outlined-required\",label:\"Mot de passe\",type:\"password\",helperText:error?error:'',error:error?true:false,defaultValue:password,onChange:handlePasswordChange}),/*#__PURE__*/_jsx(Button,{content:\"se connecter\",onClick:function onClick(){login();}}),/*#__PURE__*/_jsx(Link,{to:\"/creer-mon-compte\",sx:{margin:\"0 auto\"},children:\"Je n'ai pas encore de compte\"})]})]});};export default SignIn;","map":{"version":3,"names":["React","useEffect","useState","useContext","Link","useNavigate","authContext","baseUrl","axios","ThemeColors","Theme","pxToRem","TextField","Button","Text","SignCard","H1","styled","getLoginToken","getAuth","StyledSignContainer","div","StyledContentSignContainer","secondary","StyledLink","a","padding","sm","lg","border","radius","tertiary","SignIn","navigate","auth","setTokenToContext","SetUserIsLog","user","setUserDataToContext","error","setError","email","setEmail","password","setPassword","handleEmailChange","e","target","value","handlePasswordChange","login","getToken","token","data","authData","role","console","log","margin"],"sources":["/home/virgile/mpp/src/Components/SignIn/index.js"],"sourcesContent":["import React, {useEffect, useState, useContext} from 'react';\nimport {Link, useNavigate} from 'react-router-dom';\nimport { authContext } from '../Contexts';\nimport baseUrl from '../../Config/baseUrl'\nimport axios from 'axios';\nimport ThemeColors from '../../Config/theme/colors'\nimport Theme from '../../Config/theme/styles'\nimport pxToRem from '../../Services/pxToRem'\nimport {TextField} from '@mui/material';\nimport Button from '../Button'\nimport Text from '../Text'\nimport SignCard from '../SignCard'\nimport H1 from '../H1'\nimport styled from 'styled-components'\nimport getLoginToken from '../../Services/login'\nimport getAuth from '../../Services/getAuth'\n\nconst StyledSignContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    width: 500px;\n    height: 400px;\n    margin: 0 auto;\n`\nconst StyledContentSignContainer = styled.div`\n    min-width: 40%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    text-align: center;\n    background-color: ${ThemeColors.secondary}\n`\n\nconst StyledLink = styled.a`\n    max-width: ${pxToRem(200)};\n    align-self:center;\n    padding: ${Theme.padding.sm} ${Theme.padding.lg};\n    text-decoration: none;\n    color: white;\n    border: ${Theme.border.sm} solid white;\n    border-radius: ${Theme.radius.lg};\n    font-size:${pxToRem(20)};\n    margin-bottom: ${pxToRem(25)};\n\n    &:hover {\n        background-color: ${ThemeColors.tertiary};\n        border: ${Theme.border.sm} solid ${ThemeColors.tertiary};\n    }\n`\n\nconst SignIn = () => {\n    const navigate = useNavigate();\n    // const {user, setUser} = useContext(UserContext)\n    const {auth, setTokenToContext,  SetUserIsLog} = useContext(authContext);\n    const {user, setUserDataToContext} = useContext(authContext);\n    const [error, setError] = useState('')\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n\n    const handleEmailChange = (e) => {\n        const email = e.target.value;\n        setEmail(email);\n    }\n\n    const handlePasswordChange = (e) => {\n        const password = e.target.value;\n        setPassword(password);\n    }\n\n    const login = async () => {\n\n        try {\n            if( email === '' || password === ''){\n                setError('Les informations ne correspondent pas')\n            }\n            const getToken = await getLoginToken(email, password)\n            const token = getToken.data.token;\n            const user = await getAuth(token)\n            if(user){\n                setTokenToContext(user.data.token);\n                SetUserIsLog(true);\n                setUserDataToContext(user.data.authData, user.data.token)\n            }\n\n            setEmail('');\n            setPassword('');\n            if(user.data.authData.role === \"admin\"){\n                navigate('/back-office', {user: user.data.authData});\n            } else {\n\n                navigate('/mon-potager', user.data.authData);\n            }\n        } catch(error) {\n            console.log(error)\n        }\n\n    }\n    useEffect(() => {\n\n    }, [])\n\n    return(\n        <SignCard>\n            <StyledContentSignContainer>\n                <H1 content=\"Rejoignez nous \" />\n                <Text content = \"Créez votre compte et commencez à utiliser nos services\" />\n                <StyledLink href=\"/creer-mon-compte\"> Créer mon compte !</StyledLink>\n            </StyledContentSignContainer>\n            <StyledSignContainer>\n                <H1 content=\"Connexion à mon compte\"/>\n                \n                <TextField\n                required\n                id=\"email_outlined-required\"\n                label=\"Email\"\n                defaultValue={email}\n                helperText={error ? error : ''}\n                onChange={handleEmailChange}\n                error={error ? true : false}\n                \n                />\n                <TextField\n                required\n                id=\"password_outlined-required\"\n                label=\"Mot de passe\"\n                type=\"password\"\n                helperText={error ? error : ''}\n                error={error ? true : false}\n                defaultValue={password}\n                onChange={handlePasswordChange}\n                />\n                <Button \n                    content=\"se connecter\"\n                    onClick={() => { \n                        login()\n                    }}\n                />\n\n                <Link to=\"/creer-mon-compte\" sx={{margin:\"0 auto\"}}>Je n'ai pas encore de compte</Link>\n\n            </StyledSignContainer>\n        </SignCard>\n    )\n}\n  \nexport default SignIn;"],"mappings":"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"},"metadata":{},"sourceType":"module"}